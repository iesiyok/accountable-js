{"version":3,"file":"js/swap-kyc-handler.js","mappings":"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A;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA;WACA;WACA,kBAAkB,qBAAqB;WACvC,oHAAoH,iDAAiD;WACrK;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,E;;;;;WC7BA;WACA;WACA;WACA,eAAe,4BAA4B;WAC3C,eAAe;WACf,iCAAiC,WAAW;WAC5C;WACA,E;;;;;WCPA,uDAAuD,qCAAqC,kBAAkB;WAC9G;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,sDAAsD;WACtD,sCAAsC,iEAAiE;WACvG,8DAA8D,wBAAwB,uBAAuB;WAC7G;WACA,+BAA+B;WAC/B;WACA;WACA,E;;;;;WCzBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF,E;;;;;WCRA;WACA;WACA;WACA;WACA,E;;;;;WCJA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC,I;;;;;WCPD;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF;WACA,E;;;;;WCVA,8CAA8C,yD;;;;;WCA9C;WACA;WACA;WACA;WACA,uBAAuB,4BAA4B;WACnD;WACA;WACA;WACA,iBAAiB,oBAAoB;WACrC;WACA,mGAAmG,YAAY;WAC/G;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,4CAA4C,mBAAmB;WAC/D;WACA;WACA;WACA,mEAAmE,iCAAiC;WACpG;WACA;WACA;WACA,E;;;;;WCzCA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;WCNA;WACA;WACA;WACA;WACA,E;;;;;WCJA,4B;;;;;WCAA;;WAEA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;WACA,iCAAiC;;WAEjC;WACA;WACA;WACA,KAAK;WACL,eAAe;WACf;WACA,2DAA2D,oEAAoE;WAC/H;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM;WACN;WACA;WACA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA,8CAA8C;;WAE9C;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,iCAAiC,mCAAmC;WACpE;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM,qBAAqB;WAC3B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA,4G;;;;;UEvFA;UACA;UACA;UACA,0GAA0G,0DAA0D;UACpK","sources":["webpack://@nimiq/wallet/./src/swap-kyc-handler.ts","webpack://@nimiq/wallet/webpack/bootstrap","webpack://@nimiq/wallet/webpack/runtime/chunk loaded","webpack://@nimiq/wallet/webpack/runtime/compat get default export","webpack://@nimiq/wallet/webpack/runtime/create fake namespace object","webpack://@nimiq/wallet/webpack/runtime/define property getters","webpack://@nimiq/wallet/webpack/runtime/ensure chunk","webpack://@nimiq/wallet/webpack/runtime/get javascript chunk filename","webpack://@nimiq/wallet/webpack/runtime/global","webpack://@nimiq/wallet/webpack/runtime/harmony module decorator","webpack://@nimiq/wallet/webpack/runtime/hasOwnProperty shorthand","webpack://@nimiq/wallet/webpack/runtime/load script","webpack://@nimiq/wallet/webpack/runtime/make namespace object","webpack://@nimiq/wallet/webpack/runtime/node module decorator","webpack://@nimiq/wallet/webpack/runtime/publicPath","webpack://@nimiq/wallet/webpack/runtime/jsonp chunk loading","webpack://@nimiq/wallet/webpack/before-startup","webpack://@nimiq/wallet/webpack/startup","webpack://@nimiq/wallet/webpack/after-startup"],"sourcesContent":["// Swap kyc handler that handles TEN31 Pass KYC and forwards the result to hub create-swap request.\n// We invoke TEN31 Pass and the Nimiq Hub via redirects in this single wallet popup to avoid having to open separate\n// popups for TEN31 Pass and the Hub.\n// As sessionStorage is sand-boxed for separate windows, we use it here for storing the request and intermediary results\n// to still be available on reloads and after returning from redirects, without affecting the Wallet main window and\n// potential other Wallet windows or swaps. However, for the case that the wallet is configured to use redirects, we\n// still clear the swap kyc handler storage after requests.\n\nimport type VueI18n from 'vue-i18n';\nimport HubApi, { SetupSwapRequest, SetupSwapResult } from '@nimiq/hub-api';\nimport { BehaviorType } from '@nimiq/hub-api/dist/src/client/RequestBehavior.d';\nimport Ten31PassApi, { GrantResponse, ResponseType, ServiceRequest } from '@nimiq/ten31-pass-api';\nimport { ResponseStatus, RpcServer, State as RpcServerState } from '@nimiq/rpc';\nimport { FormattableNumber } from '@nimiq/utils';\nimport Config from 'config';\nimport { KycProvider, KycUser } from './stores/Kyc';\nimport { i18n, detectLanguage, loadLanguage } from './i18n/i18n-setup';\n\nexport interface SetupSwapWithKycResult extends SetupSwapResult {\n    kyc: {\n        provider: KycProvider.TEN31PASS,\n        s3GrantToken: string, // JWT token representing the S3 service grant\n        oasisGrantToken?: string, // JWT token representing the OASIS service grant\n    };\n}\n\ninterface KycResponse {\n    provider: KycProvider.TEN31PASS;\n    grantResponse: GrantResponse;\n    s3GrantToken: string;\n    oasisGrantToken?: string;\n}\n\ninterface SwapKycHandlerStorage {\n    rpcServerState?: string;\n    request?: SetupSwapRequest;\n    kycUser?: KycUser;\n    kycResponse?: KycResponse;\n}\n\nexport type SWAP_KYC_HANDLER_STORAGE_KEY = 'wallet-swap-kyc-handler';\nconst SWAP_KYC_HANDLER_STORAGE_KEY: SWAP_KYC_HANDLER_STORAGE_KEY = 'wallet-swap-kyc-handler';\n\nfunction readSwapKycHandlerStorage(): [RpcServerState?, SetupSwapRequest?, KycUser?, KycResponse?] {\n    try {\n        const swapKycHandlerStorageJson = sessionStorage[SWAP_KYC_HANDLER_STORAGE_KEY] || '{}';\n        const swapKycHandlerStorage: SwapKycHandlerStorage = JSON.parse(swapKycHandlerStorageJson);\n        return [\n            swapKycHandlerStorage.rpcServerState\n                ? RpcServerState.fromJSON(swapKycHandlerStorage.rpcServerState)\n                : undefined,\n            swapKycHandlerStorage.request,\n            swapKycHandlerStorage.kycUser,\n            swapKycHandlerStorage.kycResponse,\n        ];\n    } catch (e) {\n        return [];\n    }\n}\n\nfunction writeSwapKycHandlerStorage(\n    rpcServerState?: RpcServerState,\n    request?: SetupSwapRequest,\n    kycUser?: KycUser,\n    kycResponse?: KycResponse,\n) {\n    const swapKycHandlerStorage: SwapKycHandlerStorage = {\n        rpcServerState: rpcServerState ? rpcServerState.toJSON() : undefined,\n        request,\n        kycUser,\n        kycResponse,\n    };\n    sessionStorage[SWAP_KYC_HANDLER_STORAGE_KEY] = JSON.stringify(swapKycHandlerStorage);\n}\n\nfunction clearSwapKycHandlerStorage() {\n    sessionStorage.removeItem(SWAP_KYC_HANDLER_STORAGE_KEY);\n}\n\nfunction toDecimalString(amount: number, decimals: number): string {\n    // Convert to decimal string without the risk of potential floating division imprecision occurring\n    return new FormattableNumber(amount).moveDecimalSeparator(-1 * decimals).toString();\n}\n\n// For translating error messages which get displayed in the UI.\n// Translate on a best effort basis; if language file has not been loaded yet, return a fallback. The method is called\n// $t such that source strings in calls to it get detected by our webpack-i18n-tools extractor. It's essentially the\n// same as VueI18n's $t but extended by the fallback string which will be returned if the language file has not been\n// loaded yet. Note that we're not just using the key as fallback because, webpack-i18n-tools optimizes these away to be\n// just simple index numbers.\nloadLanguage(detectLanguage());\ni18n.missing = () => ''; // don't return index numbers before language loaded; same as set in i18n-setup for production\nfunction $t(key: VueI18n.Path, fallback: string): string;\nfunction $t(key: VueI18n.Path, values: VueI18n.Values, fallback: string): string;\nfunction $t(key: VueI18n.Path, valuesOrFallback: VueI18n.Values | string, fallback?: string): string {\n    return i18n.t(key, typeof valuesOrFallback !== 'string' ? valuesOrFallback : undefined) as string\n        // The translation was missing and i18n.t returned an empty string as configured by i18n.missing\n        || (typeof valuesOrFallback === 'string' ? valuesOrFallback : fallback!);\n}\n\nasync function run() {\n    let rpcServerState: RpcServerState | undefined;\n    let request: SetupSwapRequest | undefined;\n    let kycUser: KycUser | undefined;\n    let kycResponse: KycResponse | undefined;\n    try {\n        [rpcServerState, request, kycUser, kycResponse] = readSwapKycHandlerStorage();\n\n        // Listen for initial request if not known yet.\n        if (!rpcServerState || !request || !kycUser) {\n            [rpcServerState, request, kycUser] = await new Promise<[RpcServerState, SetupSwapRequest, KycUser]>((\n                resolve,\n                reject,\n            ) => {\n                const rpcServer = new RpcServer(/* allowed origins */ window.location.origin);\n                // no need to parse/validate the request as we are the only allowed origin\n                rpcServer.onRequest(HubApi.RequestType.SETUP_SWAP, (state, req, user) => resolve([state, req, user]));\n                rpcServer.init(/* onClientTimeout */ () =>\n                    reject(new Error($t('No request received.', 'No request received.'))));\n            });\n            writeSwapKycHandlerStorage(rpcServerState, request, kycUser, kycResponse);\n        }\n\n        // Request TEN31 Pass grants or check for TEN31 Pass redirect response.\n        if (kycUser.provider === KycProvider.TEN31PASS) {\n            const ten31PassApi = new Ten31PassApi(Config.ten31Pass.apiEndpoint);\n            const grantResponse = ten31PassApi.getRedirectGrantResponse()?.response;\n            const s3ServiceId = Config.ten31Pass.services.s3.serviceId;\n            const oasisServiceId = Config.ten31Pass.services.oasis.serviceId;\n            // console.log('Swap kyc handler TEN31 Pass response referrer', document.referrer); // eslint-disable-line\n\n            // Request grants if we didn't get them yet.\n            if (!kycResponse && !grantResponse) {\n                // Note that all amounts in the grants refer to the values S3 initially gave us on createSwap. As the\n                // Hub partially operates on different values, we need to revert this preprocessing here that the Wallet\n                // did on the original values. More specifically, we want to get the original swapSuggestion values back\n                // that were modified in the hubRequest in SwapModal, BuyCryptoModal and SellCryptoModal.\n                const serviceRequests: ServiceRequest[] = [{\n                    serviceId: s3ServiceId,\n                    usages: [{\n                        usageId: Config.ten31Pass.services.s3.usageIds.swap,\n                        parameters: {\n                            from_amount: (() => {\n                                switch (request.fund.type) {\n                                    case 'NIM': return toDecimalString(request.fund.value, 5);\n                                    case 'BTC': return toDecimalString(request.fund.output.value, 8);\n                                    case 'EUR': return toDecimalString(request.fund.value + request.fund.fee, 2);\n                                    default: throw new Error($t('Unsupported currency', 'Unsupported currency'));\n                                }\n                            })(),\n                            from_asset: request.fund.type,\n                            to_amount: (() => {\n                                switch (request.redeem.type) {\n                                    case 'NIM': return toDecimalString(request.redeem.value + request.redeem.fee, 5);\n                                    case 'BTC': return toDecimalString(request.redeem.input.value, 8);\n                                    case 'EUR': return toDecimalString(request.redeem.value, 2);\n                                    default: throw new Error($t('Unsupported currency', 'Unsupported currency'));\n                                }\n                            })(),\n                            to_asset: request.redeem.type,\n                            id: request.swapId,\n                        },\n                    }],\n                }];\n                if (request.fund.type === 'EUR') {\n                    serviceRequests.push({\n                        serviceId: oasisServiceId,\n                        usages: [{\n                            usageId: Config.ten31Pass.services.oasis.usageIds.clearing,\n                            parameters: {\n                                amount: request.fund.value + request.fund.fee,\n                            },\n                        }],\n                    });\n                } else if (request.redeem.type === 'EUR') {\n                    serviceRequests.push({\n                        serviceId: oasisServiceId,\n                        usages: [{\n                            usageId: Config.ten31Pass.services.oasis.usageIds.settling,\n                            parameters: {\n                                amount: request.redeem.value,\n                            },\n                        }],\n                    });\n                }\n                // Redirect to TEN31 Pass.\n                await ten31PassApi.requestGrants(\n                    Config.ten31Pass.appId,\n                    serviceRequests,\n                    /* asPopup */ false,\n                    {\n                        preferredResponseType: ResponseType.IMMEDIATE_REDIRECT,\n                    },\n                );\n                return;\n            }\n\n            // Process and store new or changed grantResponse (for the case that the user navigated back and gave grants\n            // again). If we just got the same grantResponse we already know, we don't want to process it again. We can\n            // simply base the equality check on the json representation, as for same grant responses also the order of\n            // object entries should be the same.\n            const isChangedGrantResponse = JSON.stringify(grantResponse) !== JSON.stringify(kycResponse?.grantResponse);\n            if (grantResponse && (!kycResponse || isChangedGrantResponse)) {\n                const s3Grant = grantResponse.services[s3ServiceId];\n                const oasisGrant = grantResponse.services[oasisServiceId];\n                const isOasisSwap = request.fund.type === 'EUR' || request.redeem.type === 'EUR';\n                if (!s3Grant || (isOasisSwap && !oasisGrant)) {\n                    throw new Error($t(\n                        'TEN31 Pass didn\\'t return expected grants.',\n                        'TEN31 Pass didn\\'t return expected grants.',\n                    ));\n                }\n                if (grantResponse.app !== kycUser.appGrant) {\n                    throw new Error($t(\n                        'Unexpected user. This account is currently connected to the TEN31 Pass of {userName}.',\n                        { userName: kycUser.name },\n                        `Unexpected user. This account is currently connected to the TEN31 Pass of ${kycUser.name}.`,\n                    ));\n                }\n                const [s3GrantToken, oasisGrantToken] = await Promise.all([\n                    ten31PassApi.getServiceGrantInfo(s3Grant),\n                    oasisGrant ? ten31PassApi.getServiceGrantInfo(oasisGrant) : Promise.resolve(null),\n                ].map((serviveGrantPromise) => serviveGrantPromise.then((serviceGrant) => serviceGrant?.token)));\n                if (!s3GrantToken || (isOasisSwap && !oasisGrantToken)) {\n                    throw new Error($t(\n                        'TEN31 Pass didn\\'t return expected grants.',\n                        'TEN31 Pass didn\\'t return expected grants.',\n                    ));\n                }\n                kycResponse = {\n                    provider: KycProvider.TEN31PASS,\n                    grantResponse,\n                    s3GrantToken,\n                    oasisGrantToken,\n                };\n                writeSwapKycHandlerStorage(rpcServerState, request, kycUser, kycResponse);\n            } else if (!kycResponse) {\n                // This can't happen based on the checks above. This is just a type guard for typescript.\n                throw new Error('Unexpected');\n            }\n        } else {\n            throw new Error($t(\n                'Unsupported KYC provider {provider}.',\n                { provider: kycUser.provider },\n                `Unsupported KYC provider ${kycUser.provider}.`,\n            ));\n        }\n\n        // Launch Hub swap creation flow or check for Hub redirect response.\n        const hubApi = new HubApi(Config.hubEndpoint);\n        const setupSwapResult = await new Promise<SetupSwapResult | undefined>((resolve, reject) => {\n            // triggered by checkRedirectResponse if there is a response\n            hubApi.on(HubApi.RequestType.SETUP_SWAP, resolve, reject);\n            hubApi.checkRedirectResponse().then(() => resolve(undefined));\n        });\n        // Redirect to Hub if we didn't get the hub response yet.\n        if (!setupSwapResult) {\n            await hubApi.setupSwap<BehaviorType.REDIRECT>({\n                ...request,\n                kyc: {\n                    ...kycResponse,\n                    userId: kycUser.id,\n                },\n            }, new HubApi.RedirectRequestBehavior());\n            return;\n        }\n\n        // Return result\n        const setupSwapWithKycResult: SetupSwapWithKycResult = {\n            ...setupSwapResult,\n            kyc: kycResponse,\n        };\n        clearSwapKycHandlerStorage();\n        rpcServerState.reply(ResponseStatus.OK, setupSwapWithKycResult);\n    } catch (e: any) {\n        clearSwapKycHandlerStorage();\n        if (rpcServerState) {\n            rpcServerState.reply(ResponseStatus.ERROR, e);\n        } else if (window.opener) {\n            // Can't report error as we don't know the request id. Display a good old alert.\n            alert($t( // eslint-disable-line no-alert\n                'An error occurred: {message}',\n                { message: e.message || e },\n                `An error occurred: ${e.message || e}`,\n            ));\n            window.close();\n        } else {\n            // We're in fact not a popup but were opened by hub.ts as redirect. Go back to Wallet main UI.\n            window.location.assign(window.location.origin);\n        }\n    }\n}\nrun();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = function(module) {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: function() {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"@nimiq/wallet:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"swap-kyc-handler\": 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk_nimiq_wallet\"] = self[\"webpackChunk_nimiq_wallet\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"chunk-vendors\",\"chunk-common\"], function() { return __webpack_require__(\"./src/swap-kyc-handler.ts\"); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":["HubApi","Ten31PassApi","ResponseType","ResponseStatus","RpcServer","State","RpcServerState","FormattableNumber","Config","KycProvider","i18n","detectLanguage","loadLanguage","SWAP_KYC_HANDLER_STORAGE_KEY","readSwapKycHandlerStorage","swapKycHandlerStorageJson","sessionStorage","swapKycHandlerStorage","JSON","parse","rpcServerState","fromJSON","undefined","request","kycUser","kycResponse","e","writeSwapKycHandlerStorage","toJSON","stringify","clearSwapKycHandlerStorage","removeItem","toDecimalString","amount","decimals","moveDecimalSeparator","toString","missing","$t","key","valuesOrFallback","fallback","t","run","Promise","resolve","reject","rpcServer","window","location","origin","onRequest","RequestType","SETUP_SWAP","state","req","user","init","Error","provider","TEN31PASS","ten31PassApi","ten31Pass","apiEndpoint","grantResponse","getRedirectGrantResponse","response","s3ServiceId","services","s3","serviceId","oasisServiceId","oasis","serviceRequests","usages","usageId","usageIds","swap","parameters","from_amount","fund","type","value","output","fee","from_asset","to_amount","redeem","input","to_asset","id","swapId","push","clearing","settling","requestGrants","appId","preferredResponseType","IMMEDIATE_REDIRECT","isChangedGrantResponse","s3Grant","oasisGrant","isOasisSwap","app","appGrant","userName","name","s3GrantToken","oasisGrantToken","all","getServiceGrantInfo","map","serviveGrantPromise","then","serviceGrant","token","hubApi","hubEndpoint","setupSwapResult","on","checkRedirectResponse","setupSwap","kyc","userId","RedirectRequestBehavior","setupSwapWithKycResult","reply","OK","ERROR","opener","alert","message","close","assign"],"sourceRoot":""}