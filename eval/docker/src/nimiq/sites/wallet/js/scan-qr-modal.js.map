{"version":3,"file":"js/scan-qr-modal.js","mappings":"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","sources":["webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?e93f","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?e08e","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?07ee","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?9fed","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?2cdd","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?d1eb","webpack://@nimiq/wallet/./src/components/modals/ScanQrModal.vue?b5ba"],"sourcesContent":["import { render, staticRenderFns } from \"./ScanQrModal.vue?vue&type=template&id=48d884d4&scoped=true&\"\nimport script from \"./ScanQrModal.vue?vue&type=script&lang=ts&\"\nexport * from \"./ScanQrModal.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ScanQrModal.vue?vue&type=style&index=0&id=48d884d4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"48d884d4\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/iesiyok/projects/acc-js/development/nimiq2/wallet/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('48d884d4')) {\n      api.createRecord('48d884d4', component.options)\n    } else {\n      api.reload('48d884d4', component.options)\n    }\n    module.hot.accept(\"./ScanQrModal.vue?vue&type=template&id=48d884d4&scoped=true&\", function () {\n      api.rerender('48d884d4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/modals/ScanQrModal.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=template&id=48d884d4&scoped=true&\"","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=script&lang=ts&\"","export * from \"-!../../../node_modules/vue-style-loader/index.js??clonedRuleSet-22[0].rules[0].use[0]!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=style&index=0&id=48d884d4&lang=scss&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"Modal\",\n    { staticClass: \"scan-qr-modal\", attrs: { swipePadding: false } },\n    [\n      _c(\n        \"PageBody\",\n        [\n          _c(\"QrScanner\", {\n            on: {\n              result: _vm.checkResult,\n              cancel: function($event) {\n                return _vm.$router.back()\n              }\n            }\n          })\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\nimport { defineComponent } from '@vue/composition-api';\nimport { PageBody, QrScanner } from '@nimiq/vue-components';\nimport {\n    parseRequestLink,\n    createNimiqRequestLink,\n    NimiqRequestLinkType,\n    ValidationUtils,\n    createBitcoinRequestLink,\n} from '@nimiq/utils';\nimport Config from 'config';\nimport Modal from './Modal.vue';\nimport { useRouter } from '../../router';\nimport { parseBitcoinUrl, validateAddress } from '../../lib/BitcoinTransactionUtils';\nimport { ENV_MAIN } from '../../lib/Constants';\nimport { loadBitcoinJS } from '../../lib/BitcoinJSLoader';\nimport { useAccountStore } from '../../stores/Account';\n\nexport default defineComponent({\n    name: 'scan-qr-modal',\n    setup() {\n        const router = useRouter();\n        const checkResult = async (result: string) => {\n            // NIM Address\n            if (ValidationUtils.isValidAddress(result)) {\n                router.replace(`/${createNimiqRequestLink(result, {\n                    type: NimiqRequestLinkType.URI,\n                })}`);\n                return;\n            }\n\n            // parseRequestLink has not implemented urischemes appending an url yet.\n            // checkResult('http://localhost:8081/nimiq:NQ35SB3EB8XAESYER574SJA4EEFTX0VQQ5T1?amount=12&message=asd');\n            // does not give an result for any of the below combinations of arguments to parseRequestLink\n            result = result.replace(`${window.location.origin}/`, '');\n\n            // NIM Request Link\n            try {\n                const requestLink = parseRequestLink(result, undefined, true)\n                    || parseRequestLink(result, 'safe.nimiq.com', true)\n                    || parseRequestLink(result, 'safe.nimiq-testnet.com', true);\n\n                if (requestLink) {\n                    // console.error(requestLink);\n                    // replace old request Link formats with the new one and redirect.\n                    router.replace(`/${createNimiqRequestLink(requestLink.recipient, {\n                        ...requestLink,\n                        type: NimiqRequestLinkType.URI,\n                    })}`);\n                    return;\n                }\n            } catch (error) {\n                // Ignore\n            }\n\n            // Cashlink\n            if (/https:\\/\\/hub\\.nimiq(-testnet)?\\.com\\/cashlink\\//.test(result)) {\n                // result is a cashlink so redirect to hub\n                window.location.href = result;\n                return;\n            }\n\n            // Nimiq-controlled short-links\n            if (/https:\\/\\/nim\\.id\\/.+/.test(result)) {\n                window.location.href = result;\n                return;\n            }\n\n            const { hasBitcoinAddresses } = useAccountStore();\n            if (hasBitcoinAddresses.value) {\n                await loadBitcoinJS();\n\n                // BTC Address\n                if (validateAddress(result, Config.environment === ENV_MAIN ? 'MAIN' : 'TEST')) {\n                    router.replace(`/${createBitcoinRequestLink(result)}`);\n                    return;\n                }\n\n                // BTC Request Link\n                try {\n                    parseBitcoinUrl(result);\n                    // If the above does not throw, we have a valid BTC request link\n                    router.replace(`/${result}`);\n                    return; // eslint-disable-line no-useless-return\n                } catch (error) {\n                    // Ignore\n                }\n            }\n        };\n\n        return {\n            checkResult,\n        };\n    },\n    components: {\n        PageBody,\n        QrScanner,\n        Modal,\n    },\n});\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".modal[data-v-48d884d4]  .close-button {\\n  display: none;\\n}\\n.page-body[data-v-48d884d4] {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-evenly;\\n  padding: 1rem;\\n}\\n.qr-scanner[data-v-48d884d4] {\\n  border-radius: 0.5rem;\\n  flex-grow: 1;\\n}\\n@media (max-width: 700px) {\\n.modal[data-v-48d884d4]  .wrapper,\\n.modal[data-v-48d884d4]  .small-page {\\n    height: 100%;\\n    max-height: 100%;\\n    border-radius: 0;\\n    min-width: 100vw;\\n}\\n.modal[data-v-48d884d4]  .swipe-bar {\\n    background: var(--text-20);\\n    -webkit-backdrop-filter: invert(1);\\n            backdrop-filter: invert(1);\\n}\\n.page-body[data-v-48d884d4] {\\n    padding: 0;\\n}\\n.qr-scanner[data-v-48d884d4] {\\n    border-radius: 0;\\n}\\n.qr-scanner[data-v-48d884d4]  .cancel-button {\\n    bottom: 6rem;\\n}\\n.qr-scanner[data-v-48d884d4]  .access-denied-instructions {\\n    bottom: 13rem;\\n}\\n}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=style&index=0&id=48d884d4&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"bbbd8d60\", content, false, {\"sourceMap\":false,\"shadowMode\":false});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=style&index=0&id=48d884d4&lang=scss&scoped=true&\", function() {\n     var newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ScanQrModal.vue?vue&type=style&index=0&id=48d884d4&lang=scss&scoped=true&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["defineComponent","PageBody","QrScanner","parseRequestLink","createNimiqRequestLink","NimiqRequestLinkType","ValidationUtils","createBitcoinRequestLink","Config","Modal","useRouter","parseBitcoinUrl","validateAddress","ENV_MAIN","loadBitcoinJS","useAccountStore","name","setup","router","checkResult","result","isValidAddress","replace","type","URI","window","location","origin","requestLink","undefined","recipient","error","test","href","hasBitcoinAddresses","value","environment","components"],"sourceRoot":""}